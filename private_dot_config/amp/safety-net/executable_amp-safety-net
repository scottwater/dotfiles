#!/usr/bin/env ruby
# frozen_string_literal: true

# Amp Safety Net - A delegate script for blocking destructive commands.
#
# Amp Delegate Protocol:
#   - Exit 0 → allow the command
#   - Exit 1 → ask the operator for approval
#   - Exit ≥2 → reject (stderr is surfaced to the model)
#
# Usage:
#   Configure in Amp permissions with:
#     amp permissions add Bash --action delegate --to amp-safety-net
#
# Environment Variables:
#   SAFETY_NET_STRICT=1        - Fail-closed on unparseable commands
#   SAFETY_NET_PARANOID=1      - Enable all paranoid checks
#   SAFETY_NET_PARANOID_RM=1   - Block rm -rf even in cwd
#   SAFETY_NET_PARANOID_INTERPRETERS=1 - Block python -c, node -e, etc.
#   SAFETY_NET_ALLOW_TMP_RM=0  - Block rm -rf in /tmp, /var/tmp, $TMPDIR

require_relative "safety_net_impl/hook"
exit SafetyNetImpl::Hook.run
